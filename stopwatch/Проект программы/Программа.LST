C51 COMPILER V9.53.0.0   _________                                                         11/12/2019 11:14:32 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE _________
OBJECT MODULE PLACED IN œÓ„‡ÏÏ‡.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE œÓ„‡ÏÏ‡.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          //–ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞
   2          #include<reg51.h>
   3          //#include<at89x51.h>
   4          
   5          //–¢–∏–∫ —Ç–∞–π–º–µ—Ä–∞
   6          #define tik (10000)
   7          //–ß–∏—Å–ª–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –º–∞—Ç—Ä–∏—Ü–µ
   8          #define countColumn 7
   9          //–®–∏—Ä–∏–Ω–∞ —Ü–∏—Ñ—Ä—ã
  10          #define digitWidth 3
  11          //–ü–∞—É–∑–∞ 1–º—Å
  12          #define delay1ms delayFOR(99)
  13          
  14          //–°—á–µ—Ç—á–∏–∫ –≤—Ä–µ–º–µ–Ω–∏
  15          unsigned char count10ms=0;
  16          
  17          //–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
  18          //0 - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–µ–∫—É–Ω–¥—ã
  19          //1 - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–∏–Ω—É—Ç—ã
  20          //2 - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–∞—Å—ã
  21          unsigned char mode = 0;
  22          
  23          //–£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç–æ–ª–±–µ—Ü
  24          unsigned char ptrColumn = 0;
  25          
  26          //–í—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  27          unsigned char timeSec = 0;
  28          //–í—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö
  29          unsigned char timeMin = 0;
  30          //–í—Ä–µ–º—è –≤ —á–∞—Å–∞—Ö
  31          unsigned char timeHour = 0;
  32          
  33          //–ú–∞—Å—Å–∏–≤—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–∏—Ñ—Ä
  34          //–ó–∞ —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≥–æ—Ä–µ—Ç—å –≤ —Å—Ç–æ–ª–±—Ü–µ, –æ—Ç–≤–µ—á–∞—é—Ç 
             -–ø–µ—Ä–≤—ã–µ 5 –±–∏—Ç–æ–≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞ P1
  35          //–ù–∞–ø—Ä–∏–º–µ—Ä, –°–º (*)
  36          data unsigned char first[digitWidth];
  37          data unsigned char second[digitWidth];
  38          
  39          //–§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏ —Ü–∏—Ñ—Ä—ã –≤ –º–∞—Å—Å–∏–≤
  40          void setData(unsigned char digit, unsigned char data *array){
  41   1          switch(digit)
  42   1          {
  43   2            //(*): –µ—Å–ª–∏ —Ü–∏—Ä–∞ 0, —Ç–æ
  44   2            case 0:
  45   2              //–í –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∑–∞–ø–∏—Å—ã–≤–∞–µ–º 1 + 2 + 4 + 8 + 16 = 1F = *****
  46   2              array[0] = 0x1F;
  47   2              //–í–æ –≤—Ç–æ—Ä–æ–π —Å—Ç–æ–ª–±–µ—Ü –∑–∞–ø–∏—Å—ã–≤–∞–µ–º 1 + 16 = 11 = *---*
  48   2              array[1] = 0x11;
  49   2              //–í —Ç—Ä–µ—Ç–∏–π —Å—Ç–æ–ª–±–µ—Ü –∑–∞–ø–∏—Å—ã–≤–∞–µ–º 1 + 2 + 4 + 8 + 16 = 1F = *****
  50   2              array[2] = 0x1F;
  51   2              //–ò—Ç–æ–≥–æ –ø–æ–ª—É—á–∞–µ–º *****
  52   2              //         *---*
  53   2              //               *****
  54   2              //–ü–æ–≤–µ—Ä–Ω—É—Ç—å –ø–æ —á–∞—Å–æ–≤–æ–π —Å—Ç—Ä–µ–ª–∫–µ; "*" - —Å–≤–µ—Ç–æ–¥–∏–æ–¥ –≥–æ—Ä–∏—Ç, "-" - —Å
C51 COMPILER V9.53.0.0   _________                                                         11/12/2019 11:14:32 PAGE 2   

             -–≤–µ—Ç–æ–¥–∏–æ–¥ –Ω–µ –≥–æ—Ä–∏—Ç
  55   2              break;
  56   2            case 1:
  57   2              array[0] = 0x04;
  58   2              array[1] = 0x02;
  59   2              array[2] = 0x1F;
  60   2              break;
  61   2            case 2:
  62   2              array[0] = 0x1B;
  63   2              array[1] = 0x15;
  64   2              array[2] = 0x17;
  65   2              break;
  66   2            case 3:
  67   2              array[0] = 0x15;
  68   2              array[1] = 0x15;
  69   2              array[2] = 0x1F;
  70   2              break;
  71   2            case 4:
  72   2              array[0] = 0x07;
  73   2              array[1] = 0x04;
  74   2              array[2] = 0x1F;
  75   2              break;
  76   2            case 5:
  77   2              array[0] = 0x17;
  78   2              array[1] = 0x15;
  79   2              array[2] = 0x1D;
  80   2              break;
  81   2            case 6:
  82   2              array[0] = 0x1F;
  83   2              array[1] = 0x15;
  84   2              array[2] = 0x1D;
  85   2              break;
  86   2            case 7:
  87   2              array[0] = 0x19;
  88   2              array[1] = 0x05;
  89   2              array[2] = 0x03;
  90   2              break;
  91   2            case 8:
  92   2              array[0] = 0x1F;
  93   2              array[1] = 0x15;
  94   2              array[2] = 0x1F;
  95   2              break;
  96   2            case 9:
  97   2              array[0] = 0x17;
  98   2              array[1] = 0x15;
  99   2              array[2] = 0x1F;
 100   2              break;
 101   2          }
 102   1      }
 103          
 104          //–§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞
 105          void nextColumn(void){
 106   1        //–°–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤
             -–∞—Ç—å, —Ç.–∫. –æ–Ω–∞ –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞, –Ω–æ —Ç–æ–ª—å–∫–æ —Å –Ω–µ–π Proteus –Ω–æ—Ä–º–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç 
             -–¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∏–Ω–¥–∏–∫–∞—Ü–∏—é
 107   1        P1 = 0;
 108   1        //–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –±–∏—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ P1 –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Ç–æ, –∫–∞–∫–æ–π —Å—Ç–æ–ª–±–µ—Ü
             - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å
 109   1        //–û–Ω–∏ –ø–æ–¥–∞—é—Ç—Å—è –Ω–∞ –¥–µ—à–∏—Ñ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –º
             -–Ω–æ–∂–µ—Å—Ç–≤–∞ {0,1,2,3,4,5,6} (–ü–æ—Å–ª–µ–¥–Ω—è—è –Ω–æ–∂–∫–∞ –¥–µ—à–∏—Ñ—Ä–∞—Ç–æ—Ä–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
 110   1        //–ò—Å—Ö–æ–¥—è –∏–∑ —Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ, –≤ P1 –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç–
             -æ–ª–±–µ—Ü —Å–º–µ—â–µ–Ω–Ω—ã–π –Ω–∞ 5 –±–∏—Ç–æ–≤ –≤–ª–µ–≤–æ –ø–æ–±–∏—Ç–Ω–æ —Å–ª–æ–∂–µ–Ω–Ω—ã–π —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–∑
C51 COMPILER V9.53.0.0   _________                                                         11/12/2019 11:14:32 PAGE 3   

             - –º–∞—Å—Å–∏–≤–∞, —Ö—Ä–∞–Ω—è—â–µ–≥–æ —Ü–∏—Ñ—Ä—É, –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é 
 111   1        //–ï—Å–ª–∏ 1 —Ü–∏—Ñ—Ä–∞, —Ç–æ –±–µ—Ä–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞ first
 112   1        if (ptrColumn >= 0 && ptrColumn < 3)
 113   1          P1 = (ptrColumn << 5) | first[ptrColumn];
 114   1        //–ï—Å–ª–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫, —Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–≤–æ–¥–∏–º
 115   1        if (ptrColumn == 3)
 116   1          P1 = (ptrColumn << 5); 
 117   1        //–ï—Å–ª–∏ 2 —Ü–∏—Ñ—Ä–∞, —Ç–æ –±–µ—Ä–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞ second
 118   1        if (ptrColumn > 3 && ptrColumn <= 7)
 119   1          P1 = (ptrColumn << 5) | second[ptrColumn - 4];
 120   1        //–ü–µ—Ä–µ—Å–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å—Ç–æ–ª–±—Ü—É
 121   1        ptrColumn++;
 122   1        //–ï—Å–ª–∏ —Å—Ç–æ–ª–±–µ—Ü –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–º, —Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –æ–ø—è—Ç—å –∫ –ø–µ—Ä–≤–æ–º—É
 123   1        if (ptrColumn == countColumn)
 124   1          ptrColumn = 0;
 125   1      }
 126          
 127          //–§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏ —Ü–∏—Ñ—Ä –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
 128          //–†–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–∏–º–µ—Ä—É –∏–∑ –∫–Ω–∏–≥–∏ 
 129          void setDigits()
 130          {
 131   1         switch(mode)
 132   1         {
 133   2           case 0:
 134   2             setData(timeSec/10, &first[0]);
 135   2             setData(timeSec%10, &second[0]);
 136   2             break;
 137   2           case 1:
 138   2             setData(timeMin/10, &first[0]);
 139   2             setData(timeMin%10, &second[0]);
 140   2             break;
 141   2           case 2:
 142   2             setData(timeHour/10, &first[0]);
 143   2             setData(timeHour%10, &second[0]);
 144   2             break;
 145   2         }
 146   1      }
 147          
 148          //–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–∞
 149          void T0init(void){
 150   1        TR0=0;
 151   1        TMOD=(TMOD&0xf0)|0x1;
 152   1        TL0=(~tik);
 153   1        TH0=(~tik)>>8;
 154   1        TR0=1;
 155   1        ET0=1; 
 156   1        EA=1;
 157   1      }
 158          
 159          //–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞; –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –Ω—É–∂–Ω–æ –≤
             -—ã–±—Ä–∞—Ç—å –æ–¥–Ω—É –∏–∑ —Å—Ç—Ä–æ–∫
 160          //void T0_int (void) __interrupt (TF0_VECTOR){
 161          void T0_int (void) interrupt 1 {
 162   1        TR0=0;
 163   1        TL0=(~tik);
 164   1        TH0=(~tik)>>8;
 165   1        TR0=1;
 166   1        count10ms++;
 167   1      }
 168          
 169          //–ü–∞—É–∑–∞ —Å –ø–æ–º–æ—â—å—é FOR
 170          void delayFOR(unsigned char kodF){
C51 COMPILER V9.53.0.0   _________                                                         11/12/2019 11:14:32 PAGE 4   

 171   1         unsigned char ml;
 172   1         for(ml = 0; ml < kodF; ml++){}
 173   1      }
 174          
 175          //–ü–∞—É–∑–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –º—Å
 176          void DelayMS(unsigned char KodMS) {
 177   1         do delay1ms;
 178   1         while(--KodMS);
 179   1      }
 180          
 181          //–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
 182          void switchMode(void){
 183   1        //–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É, —Ç.–µ. –Ω–∞ P3_0 —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –Ω–æ
             -–ª—å
 184   1        if (!RXD)
 185   1        {
 186   2            //–í—ã–∫–ª—é—á–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É
 187   2            P1 = 0;
 188   2            //–ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –¥—Ä–µ–±–µ–∑–≥
 189   2            DelayMS(10);
 190   2            //–ñ–¥–µ–º –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è
 191   2            while(!RXD);
 192   2            //–ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –¥—Ä–µ–±–µ–∑–≥
 193   2            DelayMS(10);
 194   2            //–ú–µ–Ω—è–µ–º —Ä–µ–∂–∏–º —Å —Å–µ–∫—É–Ω–¥ –Ω–∞ –º–∏–Ω—É—Ç—ã, —Å –º–∏–Ω—É—Ç –Ω–∞ —á–∞—Å—ã, —Å —á–∞—Å–æ–≤
             - –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å–µ–∫—É–Ω–¥—ã
 195   2            mode++;
 196   2            if (mode == 3)
 197   2              mode = 0;
 198   2            //–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–
             -∞
 199   2            setDigits();
 200   2        }
 201   1      }
 202          
 203          void main(void){
 204   1        //–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∞–π–º–µ—Ä
 205   1        T0init();
 206   1        //–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–∏–≤—Ä—ã (0, 0)
 207   1        setDigits();
 208   1        while(1){
 209   2          //–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –Ω–∞–∂–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ –∫–Ω–æ–ø–∫—É
 210   2          switchMode();
 211   2          //–î–µ–ª–∞–µ–º –ø–∞—É–∑—É
 212   2          delayFOR(10);
 213   2          //–ú–µ–Ω—è–µ–º —Å—Ç–æ–ª–±–µ—Ü
 214   2          nextColumn();
 215   2          //–û—Å–Ω–æ–≤–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ
 216   2          //–í –Ω–µ–º –ø—Ä–æ—Å—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Ü–∏—Ñ—
             -Ä—ã
 217   2          if (count10ms >= 100)
 218   2          {
 219   3              count10ms -= 100;
 220   3              timeSec++;
 221   3              if (timeSec == 61)
 222   3              {
 223   4                 timeSec = 0;
 224   4                 timeMin++;
 225   4                 if (timeMin == 61)
 226   4                 {
 227   5                    timeHour++;
 228   5                    timeMin = 0;
C51 COMPILER V9.53.0.0   _________                                                         11/12/2019 11:14:32 PAGE 5   

 229   5                    if (timeHour == 24)
 230   5                      timeHour = 0;
 231   5                 }
 232   4              }
 233   3              setDigits();
 234   3          }
 235   2          //–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≤ —É—Å–ª–æ–≤–∏–µ —Å—Ç–æ–∏—Ç –±–æ–ª—å—à–µ, —Ç.–∫. == –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—
             -Ç–∞—Ç—å –∏–∑-–∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∑–Ω–∞—á–∏—Ç–µ–
             -ª—å–Ω—ã–µ –ø–∞—É–∑—ã
 236   2        }
 237   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    466    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
